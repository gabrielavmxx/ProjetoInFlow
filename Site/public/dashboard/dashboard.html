<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-20">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="dashboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/heatmap.js/2.0.0/heatmap.min.js"></script>
  <script src="https://kit.fontawesome.com/6921956092.js" crossorigin="anonymous"></script>
</head>

<body>
  <div class="container">
    <!-- MENU LATERAL -->
    <div id="menu">
      <div class="logo">
        <h1>In<span>Flow</span></h1>
      </div>
      <div class="escolha">
        <div class="box">
          <div class="icon">
            <i class="fa-solid fa-chart-line"></i>
          </div>
          <p class="titulo">Dashboard</p>
        </div>
        <div class="box">
          <div class="icon">
            <i class="fa-solid fa-users"></i>
          </div>
          <a href="cadastro.html" class="titulo">Adicionar usuários</a>
        </div>
        <div class="box">
          <div class="icon">
            <i class="fa-solid fa-gear"></i>
          </div>
          <p class="titulo">Configurações</p>
        </div>
      </div>
      <div class="dadosPerfil">
        <div class="fotoPerfil conteudo">
          <img src="assets/img/homem1.jpg" alt="">
        </div>
        <div class="infoPerfil conteudo">
          <p class="nome">Renato</p>
          <p class="email">renato.silva@gmail.com</p>
        </div>
        <div class="maisInfo conteudo">
          <i class="fa-solid fa-angle-right"></i>
        </div>
      </div>
    </div>
    <!-- FIM DO MENU LATERAL -->
    <div id="main">
      <div class="conteudoDashboard">
        <div class="div_titulo_mercado">
          <h1> Carrefour 12312</h1>
        </div>
        <div class="div_escolhermes">
          <div class="logo">
            <h1>In<span>Flow</span></h1>
          </div>
          <div class="select">
            <label for="mes">Escolha o mês:</label>
            <br>
            <select id="mes">
              <option value="janeiro">Janeiro</option>
              <option value="fevereiro">Fevereiro</option>
              <option value="marco">Março</option>
              <option value="abril">Abril</option>
              <option value="maio">Maio</option>
              <option value="junho">Junho</option>
              <option value="julho">Julho</option>
              <option value="agosto">Agosto</option>
              <option value="setembro">Setembro</option>
              <option value="outubro">Outubro</option>
              <option value="novembro">Novembro</option>
              <option value="dezembro">Dezembro</option>
            </select>
            <label for="ano">Escolha o ano:</label>
            <br>
            <select id="ano">
              <option value="2023">2023</option>
              <option value="2024">2024</option>
              <option value="2025">2025</option>
              <option value="2026">2026</option>
              <option value="2027">2027</option>
              <option value="2028">2028</option>
              <option value="2029">2029</option>
              <option value="2030">2030</option>
            </select>

            <button id="btn"> Buscar</button>
          </div>

        </div>
        <div id="div_mes_escolhido"> </div>
        <div class="elementosKPI">
          <div class="kpi k1">
            <p class="titulo">Ativações totais</p>
            <div class="dados">
              <p>40000</p>

              <p>10% Maior que o mes passado</p>
            </div>
          </div>
          <div class="kpi k2">
            <p class="titulo">Corredor com maior fluxo</p>
            <div class="dados">
              <p>6</p>
              <p>Com picos a sexta no periodo da tarde</p>
            </div>
          </div>
          <div class="kpi k3">
            <p class="titulo"> Dia com maior fluxo</p>
            <div class="dados">
              <p>10</p>

            </div>
          </div>
          <div class="kpi k4">
            <p class="titulo">Corredor com queda de fluxo</p>
            <div class="dados">
              <p>Corredor 4</p>

            </div>
          </div>
        </div>
        <!-- <div class="calendar">
          <div class="header">
            <button id="prev">&#9664;</button>
            <h2 id="monthYear"></h2>
            <button id="next">&#9654;</button>
          </div>
          <div class="weekdays">
            <div>Sun</div>
            <div>Mon</div>
            <div>Tue</div>
            <div>Wed</div>
            <div>Thu</div>
            <div>Fri</div>
            <div>Sat</div>
          </div>
          <div class="days" id="calendarDays"></div>
          <div class="selection-info">
            <p>Selected: <span id="selectionDisplay">None</span></p>
          </div>
        </div> -->

        <div class="conteudoGrafico">


          <div class="grafico ">
            <canvas id="graficoPizza"></canvas>
          </div>
          <div class="grafico ">
            <canvas id="grafico2"></canvas>
          </div>
        </div>
        <div class="corredores">
          <div onclick="corredor('a')" class="corredor">
            <h3>Corredor 1</h3>
            <p>Movimentação: 10</p>
          </div>
          <div onclick="corredor('b')" class="corredor">
            <h3>Corredor 2</h3>
            <p>Movimentação: 10</p>
          </div>
          <div onclick="corredor('c')" class="corredor">
            <h3>Corredor 3</h3>
            <p>Movimentação: 10</p>
          </div>
          <div onclick="corredor('d')" class="corredor">
            <h3>Corredor 4</h3>
            <p>Movimentação: 10</p>
          </div>
          <div onclick="corredor('e')" class="corredor">
            <h3>Corredor 5</h3>
            <p>Movimentação: 10</p>
          </div>
          <div onclick="corredor('f')" class="corredor">
            <h3>Corredor 6</h3>
            <p>Movimentação: 10</p>
          </div>
        </div>
        <div id="container-corredor" class="container-corredor">
          <div class="conteudoGrafico1" id="conteudoGrafico" style="display: none;">
            <!-- <div class="grafico"> -->
            <div class="elementosKPI">
              <div class="kpi k1">
                <p class="titulo">Melhor periodo para promoções</p>
                <div class="dados">
                  <p>Manhã</p>
                </div>
              </div>
              <div class="kpi k2">
                <p class="titulo">Melhor dia do mês</p>
                <div class="dados">
                  <p>21</p>
                </div>
              </div>
            </div>
            <canvas id="grafico3" height="100"></canvas>
            <!-- </div> -->
          </div>
        </div>


        <div class="heatmaparea">
          <h1>Mapa de calor</h1>
          <p>Acompanhe em tempo real a movimentação</p>
          <div class="heatmap">
            <div id="heatmapContainer"></div>
          </div>
        </div>

      </div>
    </div>
  </div>
  </div>
  </div>
  </div>
</body>


</html>
<script>
  const ctx = document.getElementById('graficoPizza').getContext('2d');
  const graficoPizza = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['Manhã', 'Tarde', 'Noite'],
      datasets: [{
        label: 'Movimentação por período',
        data: [35, 40, 25], // porcentagens ou valores absolutos
        backgroundColor: ['#0f766e', '#14b8a6', '#5eead4'],
        borderColor: '#fff',
        borderWidth: 1
      }]
    },
    options: {
      plugins: {
        title: {
          display: true,
          text: 'Distribuição de Movimento por Período do Dia',
          font: {
            size: 18
          }
        },
        legend: {
          position: 'bottom'
        }
      }
    }
  });
  // const calendarDays = document.getElementById("calendarDays");
  // const monthYear = document.getElementById("monthYear");
  // const prev = document.getElementById("prev");
  // const next = document.getElementById("next");
  // const selectionDisplay = document.getElementById("selectionDisplay");

  // let date = new Date();
  // let selectedStart = null;
  // let selectedEnd = null;

  // function renderCalendar() {
  //   const year = date.getFullYear();
  //   const month = date.getMonth();
  //   const firstDay = new Date(year, month, 1).getDay();
  //   const lastDate = new Date(year, month + 1, 0).getDate();

  //   monthYear.textContent = `${date.toLocaleString('default', { month: 'long' })} ${year}`;
  //   calendarDays.innerHTML = "";

  //   for (let i = 0; i < firstDay; i++) {
  //     calendarDays.innerHTML += `<div></div>`;
  //   }

  //   for (let i = 1; i <= lastDate; i++) {
  //     const currentDate = new Date(year, month, i);
  //     const today = new Date();
  //     const isToday =
  //       i === today.getDate() &&
  //       month === today.getMonth() &&
  //       year === today.getFullYear();

  //     const isSelected =
  //       selectedStart &&
  //       selectedEnd &&
  //       currentDate >= selectedStart &&
  //       currentDate <= selectedEnd;

  //     const div = document.createElement("div");
  //     div.textContent = i;
  //     div.className = `${isToday ? "today" : ""} ${isSelected ? "selected" : ""}`;

  //     div.onclick = () => handleDateSelection(currentDate);
  //     calendarDays.appendChild(div);
  //   }

  //   updateSelectionDisplay();
  // }

  // function handleDateSelection(clickedDate) {
  //   if (!selectedStart || (selectedStart && selectedEnd)) {
  //     selectedStart = clickedDate;
  //     selectedEnd = null;
  //   } else if (clickedDate >= selectedStart) {
  //     selectedEnd = clickedDate;
  //   } else {
  //     selectedStart = clickedDate;
  //     selectedEnd = null;
  //   }
  //   renderCalendar();
  // }

  // function updateSelectionDisplay() {
  //   if (selectedStart && selectedEnd) {
  //     selectionDisplay.textContent = `${selectedStart.toDateString()} → ${selectedEnd.toDateString()}`;
  //   } else if (selectedStart) {
  //     selectionDisplay.textContent = `${selectedStart.toDateString()} (Start)`;
  //   } else {
  //     selectionDisplay.textContent = "None";
  //   }
  // }

  // prev.onclick = () => {
  //   date.setMonth(date.getMonth() - 1);
  //   renderCalendar();
  // };

  // next.onclick = () => {
  //   date.setMonth(date.getMonth() + 1);
  //   renderCalendar();
  // };

  const heatmapInstance = h337.create({
    container: document.getElementById('heatmapContainer'),
    radius: 70,
  });

  const data = {
    max: 100,
    data: [
      { x: 500, y: 100, value: 100 },
      { x: 400, y: 300, value: 60 },
      { x: 100, y: 400, value: 90 },
      { x: 200, y: 200, value: 40 },
      { x: 100, y: 100, value: 70 },
      { x: 250, y: 450, value: 80 },
      { x: 500, y: 400, value: 95 },
      { x: 50, y: 300, value: 40 },
    ]
  };

  heatmapInstance.setData(data);


  const ctx2 = document.getElementById('grafico2');
  const grafico2 = new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: ['Corredor 1', 'Corredor 2', 'Corredor 3', 'Corredor 4', 'Corredor 5', 'Corredor 6', 'Corredor 7', 'Corredor 8', 'Corredor 9', 'Corredor 10'],
      datasets: [{
        label: 'Pessoas', //<- legenda da tabela
        data: [10, 22, 43, 32, 11, 54, 43, 21, 55, 53], //<- muda o valor dos dados no grafico para adicionar mais valores é necessario adicionar mais corredores acima
        borderWidth: 1,
        borderColor: '#115e59',
        backgroundColor: '#115e59'
      }]
    },
    options: {
      tension: 0.5,
      scales: {
        y: {
          beginAtZero: true
        }
      },
      plugins: {
        title: {
          display: true,
          text: 'Movimentação por corredor',
          font: {
            size: 24
          },
          color: '#333' // (opcional) cor do título
        }
      }
    }
  })
  const ctx3 = document.getElementById('grafico3').getContext('2d');
  const grafico3 = new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro'],
      datasets: [{
        label: 'Pessoas',
        data: [10, 22, 43, 32, 11, 54, 43, 21, 55, 53],
        borderWidth: 1,
        borderColor: '#115e59',
        backgroundColor: '#115e59'
      }]
    },
    options: {
      tension: 0.5,
      scales: {
        y: {
          beginAtZero: true
        }
      },
      plugins: {
        title: {
          display: true,
          text: 'Movimentação por mês',
          font: {
            size: 24
          },
          color: '#333'
        }
      }
    }
  });

  var valores =
  {
    'a': [1, 2, 3, 4, 5, 6, 7, 10, 4, 1],
    'b': [7, 6, 5, 4, 3, 2, 1,1, 10, 7],
    'c': [2, 4, 6, 8, 10, 12, 14,4,7,7],
    'd': [14, 12, 10, 8, 4, 6, 2, 4,6,6],
    'e': [1, 3, 6, 9, 12, 18, 24,9,9, 10],
    'f': [9, 8, 3, 2, 5, 3, 61,9,9,8]
  }

  function corredor(item) {

    const grafico = document.getElementById('conteudoGrafico')
    grafico.style.display = 'block'

    grafico3.data.datasets[0].data = valores[item]
    grafico3.update()
  }

</script>