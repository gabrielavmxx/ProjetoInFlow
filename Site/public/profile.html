<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar perfil</title>
    <link rel="stylesheet" href="styles/style.css">
    <script src="https://kit.fontawesome.com/6921956092.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" type="imagex/png" href="assets/img/logo.ico">
</head>
<body>
    <div class="nav">
        <div>
            <p class="nav_titulo">In<span style="color: teal;">Flow</span></p>
        </div>
        <div class="nav_items">
            <a href="index.html#home" class="nav_item">Home</a>
            <a href="index.html#solucao" class="nav_item">Solução</a>
            <a href="index.html#sobrenos" class="nav_item">Sobre Nós</a>
            <a href="index.html#comofunciona" class="nav_item">Como funciona</a>
            <a href="index.html#contato" class="nav_item">Contato</a>
        </div>
        <a href="login.html" class="botao_login">
            <p>Login</p><i class="fa-solid fa-user icone_usuario"></i>
        </a>
    </div>
    
    <div class="container-todo-perfil">
        <div class="container-perfil">
            <div class="container-foto">
                <p class="paragrafo-foto">Alterar foto de perfil</p>  
                <label for="input_foto" class="botao-customizado"></label>
                <input id="input_foto" type="file" accept="image/png, image/jpeg"/>

            </div>
            <div class="container-items-foto">
                <div class="items-ipt">
                    <p class="paragrafo-foto">Alterar nome</p>
                    <input class="ipt-container-foto" type="text">
                </div>
                <div class="items-ipt">
                    <p class="paragrafo-foto">Alterar email</p>
                    <input class="ipt-container-foto" type="text">
                </div>
                <div class="items-ipt">
                    <p class="paragrafo-foto">Alterar senha</p>
                    <input class="ipt-container-foto" type="password">
                </div>
            </div>
            <button onclick="alterarDados()" class="btn-foto">Salvar dados</button>
        </div>
    </div>

    <div class="todo-rodape">
        <div class="rodape">
            <div>
                <p class="nav_titulo">In<span style="color: teal;">Flow</span></p>
            </div>
            <div class="rodape_items">
                <p>Termos de serviço</p>
                <p>Configurações de controle</p>
                <p>Politica de privacidade</p>
                <p class="direitos-autorais">2025© InFlow. Todos os direitos reservados - SPTECH</p>
            </div>

            <div class="icons-rodape">
                <i class="fa-brands fa-instagram icone"></i>
                <i class="fa-brands fa-facebook icone"></i>
                <i class="fa-brands fa-linkedin icone"></i>
            </div>
        </div>
    </div>

    <script>
        function alterarDados(){
            var fotoPerfilVar = input_foto.value;

            if (
                fotoPerfilVar == ""
            ) {
                alert('Mensagem de erro para todos os campos em branco')
                return false;
            }

            fetch("/usuarios/alterarDados", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                fotoPerfilServer: fotoPerfilVar,
                idServer: sessionStorage.ID_USUARIO
            }),
            })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {
                alert("Dados alterados com sucesso!")

                setTimeout(() => {
                    window.location = "login.html";
                }, "2000");

                } else {
                throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

            return false;
        }
    </script>
</body>
</html>